library(devtools)
load_all()
document()
document()
load_all()
check()
M1 <- matrix(rnorm(25), 5, 5)
M2 <- matrix(rnorm(25), 5, 5)
pmse(M1 = M1, M2 = M2)
tfun = function(x) all(x == 0)
matchICA.2<-function (S, template, M = NULL) {
n.comp = ncol(S)
n.obs = nrow(S)
if (n.comp > n.obs)
warning("Input should be n x d")
if (!all(dim(template) == dim(S)))
warning("Template should be n x d")
S = t(S)
template = t(template)
l2.mat1 = matrix(NA, nrow = n.comp, ncol = n.comp)
l2.mat2 = l2.mat1
for (j in 1:n.comp) {
for (i in 1:n.comp) {
l2.mat1[i, j] = sum((template[i, ] - S[j, ])^2)/n.obs
l2.mat2[i, j] = sum((template[i, ] + S[j, ])^2)/n.obs
}
}
l2.mat1 = sqrt(l2.mat1)
l2.mat2 = sqrt(l2.mat2)
l2.mat = l2.mat1 * (l2.mat1 <= l2.mat2) + l2.mat2 * (l2.mat2 <
l2.mat1)
map = as.vector(clue::solve_LSAP(l2.mat))
if(nrow(l2.mat1)==1 && ncol(l2.mat1)==1 && l2.mat1[1,1] == 0){
l2.1 = 0
} else if (nrow(l2.mat1)==1 && ncol(l2.mat1)==1){
l2.1 = as.matrix(l2.mat1[1,1])
} else {
l2.1 = diag(l2.mat1[, map])
}
if(nrow(l2.mat2)==1 && ncol(l2.mat2)==1 && l2.mat2[1,1] == 0){
l2.2 = 0
} else if (nrow(l2.mat2)==1 && ncol(l2.mat2)==1){
l2.2 = as.matrix(l2.mat2[1,1])
} else {
l2.2 = diag(l2.mat2[, map])
}
sign.change = -1 * (l2.2 < l2.1) + 1 * (l2.1 <= l2.2)
perm = diag(n.comp)[, map] %*% diag(sign.change)
s.perm = t(perm) %*% S
if (!is.null(M)) {
M.perm = t(M) %*% perm
return(list(S = t(s.perm), M = t(M.perm)))
}
else {
t(s.perm)
}
}
if (is.null(M1) && is.null(M2) && is.null(S1) && is.null(S2))
stop("need to supply either M1 and M2 or S1 and S2")
if (!is.null(M1) && !is.null(M2) && !is.null(S1) && !is.null(S2)) {
stop("provide either (M1 and M2) or (S1 and S2) but not both (M1,M2) and (S1,S2)")
}
if (!is.null(M1) && nrow(M1) > ncol(M1)){
stop("The input appears to be S1 and S2, but the arguments were not specified; re-run with S1=<object> and S2=<object>")
}
if (is.null(M1) && is.null(M2) && is.null(S1) && is.null(S2)){
stop("need to supply either M1 and M2 or S1 and S2")}
is.null(M1) && is.null(M2) && is.null(S1) && is.null(S2)
!is.null(M1) && !is.null(M2) && !is.null(S1) && !is.null(S2)
S1 = NULL
S2 = NULL
matchICA.2<-function (S, template, M = NULL) {
n.comp = ncol(S)
n.obs = nrow(S)
if (n.comp > n.obs)
warning("Input should be n x d")
if (!all(dim(template) == dim(S)))
warning("Template should be n x d")
S = t(S)
template = t(template)
l2.mat1 = matrix(NA, nrow = n.comp, ncol = n.comp)
l2.mat2 = l2.mat1
for (j in 1:n.comp) {
for (i in 1:n.comp) {
l2.mat1[i, j] = sum((template[i, ] - S[j, ])^2)/n.obs
l2.mat2[i, j] = sum((template[i, ] + S[j, ])^2)/n.obs
}
}
l2.mat1 = sqrt(l2.mat1)
l2.mat2 = sqrt(l2.mat2)
l2.mat = l2.mat1 * (l2.mat1 <= l2.mat2) + l2.mat2 * (l2.mat2 <
l2.mat1)
map = as.vector(clue::solve_LSAP(l2.mat))
if(nrow(l2.mat1)==1 && ncol(l2.mat1)==1 && l2.mat1[1,1] == 0){
l2.1 = 0
} else if (nrow(l2.mat1)==1 && ncol(l2.mat1)==1){
l2.1 = as.matrix(l2.mat1[1,1])
} else {
l2.1 = diag(l2.mat1[, map])
}
if(nrow(l2.mat2)==1 && ncol(l2.mat2)==1 && l2.mat2[1,1] == 0){
l2.2 = 0
} else if (nrow(l2.mat2)==1 && ncol(l2.mat2)==1){
l2.2 = as.matrix(l2.mat2[1,1])
} else {
l2.2 = diag(l2.mat2[, map])
}
sign.change = -1 * (l2.2 < l2.1) + 1 * (l2.1 <= l2.2)
perm = diag(n.comp)[, map] %*% diag(sign.change)
s.perm = t(perm) %*% S
if (!is.null(M)) {
M.perm = t(M) %*% perm
return(list(S = t(s.perm), M = t(M.perm)))
}
else {
t(s.perm)
}
}
is.null(M1) && is.null(M2) && is.null(S1) && is.null(S2)
!is.null(M1) && !is.null(M2) && !is.null(S1) && !is.null(S2)
!is.null(M1) && nrow(M1) > ncol(M1)
is.null(M1)
is.vector(S1)
is.vector(S2
)
nS = nrow(S1)
sum(apply(M1, 1, tfun)) + sum(apply(M2, 1, tfun))
standardize
p = ncol(M1)
d = nrow(M1)
q = nrow(M2)
n.comp = max(d, q)
n.comp > p
d < q
q < d
q
d
l2.mat1 = l2.mat2 = matrix(NA, nrow = n.comp, ncol = n.comp)
n.comp
for (j in 1:n.comp) {
for (i in 1:n.comp) {
l2.mat1[i, j] = sum((M2[i, ] - M1[j, ])^2)
l2.mat2[i, j] = sum((M2[i, ] + M1[j, ])^2)
}
}
l2.mat1 = sqrt(l2.mat1)
l2.mat2 = sqrt(l2.mat2)
l2.mat = l2.mat1 * (l2.mat1 <= l2.mat2) + l2.mat2 * (l2.mat2 <
l2.mat1)
map = as.vector(clue::solve_LSAP(l2.mat))
l2.1 = ifelse(nrow(l2.mat1)==1 && ncol(l2.mat1)==1 && l2.mat1[1,1] == 0, 0, diag(l2.mat1[, map]))
l2.2 = ifelse(nrow(l2.mat2)==1 && ncol(l2.mat2)==1 && l2.mat2[1,1] == 0, 0, diag(l2.mat2[, map]))
sign.change = -1 * (l2.2 < l2.1) + 1 * (l2.1 <= l2.2)
sign.change
diag(n.comp)[, map]
diag(sign.change)
sign.change
diag(l2.mat1[, map])
l2.mat1[, map]
l2.mat1
l2.1
p = ncol(M1)
d = nrow(M1)
q = nrow(M2)
n.comp = max(d, q)
l2.mat1 = l2.mat2 = matrix(NA, nrow = n.comp, ncol = n.comp)
for (j in 1:n.comp) {
for (i in 1:n.comp) {
l2.mat1[i, j] = sum((M2[i, ] - M1[j, ])^2)
l2.mat2[i, j] = sum((M2[i, ] + M1[j, ])^2)
}
}
l2.mat1 = sqrt(l2.mat1)
l2.mat2 = sqrt(l2.mat2)
l2.mat = l2.mat1 * (l2.mat1 <= l2.mat2) + l2.mat2 * (l2.mat2 <
l2.mat1)
map = as.vector(clue::solve_LSAP(l2.mat))
if(nrow(l2.mat1)==1 && ncol(l2.mat1)==1 && l2.mat1[1,1] == 0){
l2.1 = 0
} else{
l2.1 = diag(l2.mat1[, map])
}
l2.1
if(nrow(l2.mat2)==1 && ncol(l2.mat2)==1 && l2.mat2[1,1] == 0){
l2.2 = 0 #ifelse(, 0, diag(l2.mat2[, map]))
} else{
l2.2 = diag(l2.mat2[, map])
}
sign.change = -1 * (l2.2 < l2.1) + 1 * (l2.1 <= l2.2)
sign.change
perm = diag(n.comp)[, map] %*% diag(sign.change)
M.perm = t(perm) %*% M1
indices = c(1:n.comp)[!(apply(M.perm, 1, tfun) | apply(M2,
1, tfun))]
library(devtools)
load_all()
document()
check()
document()
load_all()
check()
## FUNC to generate list(G) of D matrix from sigma vectors
generate_d=function(sig_lst, p_vec, iso.err){
d=list()
for(k in 1:K){
if(iso.err){
d[[k]]=rep(sig_lst[[k]],p_vec[k])
} else {
d[[k]] = sig_lst[[k]]
}
}
D=diag(unlist(d))
return(D)
}
P = c(20,10)
sig = c(2,5)
temp=generate_d(sig,P,TRUE)
K = 2
temp=generate_d(sig,P,TRUE)
r.jive::show.image(temp)
View(temp)
CJIVE::show.image.2(temp)
sig = c(2,10)
temp=generate_d(sig,P,TRUE)
CJIVE::show.image.2(temp)
sig_lst = list()
for(k in 1:K){
sig_lst[[k]] = sig[k] + rnorm(P[k], sd = 0.1*sig[k])
}
d_hat=generate_d(sig_lst,P,FALSE)
CJIVE::show.image.2(d_hat)
plot(diag(d_hat))
plot(diag(temp))
library(devtools)
load_all()
check()
document()
check()
check()
load_all()
document()
check()
library(devtools)
load_all()
check()
load_all()
document()
build()
library(devtools)
load_all()
check()
?person
library(devtools)
load_all()
check()
check()
check()
check()
library(devtools)
load_all()
load_all()
load_all()
check()
build()
