# ProJIVE: Probabilistic Joint and Individual Variance Explained

## Simulations
Scripts to replicate the simulation study described in "Probabilistic Joint and Individual Variance Explained (ProJIVE) for Data Integration" are located in the "Simulations" folder. Simulations were conducted on the High Power Computing cluster (HPC) at Rollins School of Public Health, Emory University. The HPC runs the CentOS Linux operating system (currently version 8) and uses the SLURM job scheduler. Scripts are set up to run one replication per available compute node and stores results from each replication as a CSV file. The bash scripts "create_and_submit_ProJIVE_Sims_n1000.submit" and "create_and_submit_ProJIVE_Sims_n1000_MixRad.submit" build and execute bash scripts for each replicate of each setting described in the Simulation study. Each script built by the "create_and_submit" scripts will submit a job that calls on the R scripts FnRunProJIVE_Simulations_n1000.R and FnRunProJIVE_Simulations_n1000_MixRad.R to the scheduler. Lastly, the scripts "ExamineProJIVE_SimulationResults_GG_plusGIPCA_and_VarEx.R" and "ExamineProJIVE_SimulationResults_MixRad_plusGIPCA_and_VarEx.R" are used to generate graphical and numerical summaries of the simulation studies. All of the R scripts rely on the functions, scripts and packages listed in the section below. 

## Example using simulated data
The R script "PJIVE_ToyExample_Markdown" generates simulated data as described in the Simulations section of the manuscript "Probabilistic Joint and Individual Variance Explained (ProJIVE) for Data Integration." The script is written in RMarkdown and exhibits implementation of three custom functions: 1) GenerateToyData is used to generate simulated data sets for which JIVE analysis is applicable; 2) cc.jive conducts Canonical Joint and Individual Variation explained (currently under review for publication and available at request); and 3) ProJIVE_EM conducts Probabilistic JIVE. The functions that the script calls on are contained in "Functions_for_CJIVE" and "Functions_for_PJIVE." These files require the following R packages to function: ajive, Matrix, ggplot2, reshape2, fields, mvtnorm, dplyr, xtable, MASS, and extradistr.
